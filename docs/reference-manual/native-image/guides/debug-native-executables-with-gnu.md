---
layout: ni-docs
toc_group: how-to-guides
link_title: Debug Native Executables with GNU
permalink: /reference-manual/native-image/guides/debug-native-image-process/
---

# Debug Native Executables with GNU

A generated native executable is heavily optimized code with minimal symbol information which makes debugging harder.
This can be solved by embedding debug information into the resulting binary at build time.
This information tells the debugger precisely how to interpret the machine code and point it back to the original Java method.

If your Java application deployed as a native executable behaves differently than expected, you can interactively debug a running process:

- using the standard Linux GNU Debugger (GDB);
- using the built-in Java debugging in VS Code enabled with the [GraalVM Tools for Java extension](https://marketplace.visualstudio.com/items?itemName=oracle-labs-graalvm.graalvm).

In this guide you will learn how to debug a Java application running as a native executable using the GNU Debugger. 
To learn how to debug native executables in VS Code, check [this guide](../../../tools/vscode/graalvm/native-image-debugging.md).

> Note: Native Image debugging currently works on Linux with initial support for macOS. The feature is experimental.

## Run a Demo

To build a native executable with debug information, provide the `-g` option to the `native-image` builder.
This is enough to enable source-level debugging, and the debugger (GDB) then correlates machine instructions with specific source lines in Java files. 

### Prerequisities

- Linux AMD64
- GNU Debugger (GDB) 10.1 or higher

Follow the steps to test debugging a Java application running as a native executable with GDB. The below workflow is know to work on Linux OS with GDB 10.1.

1. Save the following code to the file named _GDBDemo.java_. 

2. Compile with the Graal compiler and generate a native executable with debug information:

    ```shell 
    $JAVA_HOME/bin/javac JFRDemo.java
    ```
    ```shell
    native-image -g -O0 JFRDemo
    ```
    The `-g` flag instructs `native-image` to generate debug information. The resulting image will contain debug records in a format GDB understands.

    Notice that you also pass `-O0` which specifies that no compiler optimizations should be performed. Disabling all optimizations is not required, but in general it makes the debugging experience better.

3. Launch the debugger and executae your Java application from the native executable:

    ```shell
    gdb ./jfrdemo
    ```
    The `gdb` prompt will open.
 
4. Set a breakpoint: type `breakpoint <java method>` to set a breakpoint and `run <arg>` to run the native executable. You can put breakpoints configured by file and line, or by method name. The following command places a breakpoint on the main entry point for class `GDBDemo`:

    ```
    (gdb) info func ::main
    ```

    <!-- ```
    (gdb) args.length > 0
    ``` -->
5. Pass `<arg>` to the command line. Step over to the next function call. If the image segfaults, you can print the backtrace of the entire stack (`bt`).

The debugger points machine instructions back from the binary to specific source lines in Java files. Note that single stepping within a compiled method includes file and line number information for inlined code. GDB may switch files even though you are still in the same compiled method.

Most of the regular debugging actions are suppored by GDB, namely:

  - single stepping including both into and over function calls
  - stack backtraces (not including frames detailing inlined code)
  - printing of primitive values
  - structured, field by field, printing of Java objects
  - casting and printing objects at different levels of generality
  - access through object networks via path expressions
  - reference by name to methods and static field data

The generation of debug information is implemented by modeling the Java program as an equivalent C++ program.  Since GDB was primarily designed for debugging C (and C++), there are certain considerations to be taken into account when debugging Java applications. 
Read more about Native Image debugging support from the [reference documentation](../DebugInfo.md#special-considerations-for-debugging-java-from-gdb).

### Related Documentation

- Learn more about [Debug Info Feature](../DebugInfo.md).

- Learn [how to interactively debug a running native image process from VS Code](../../../tools/vscode/graalvm/native-image-debugging.md). The GraalVM Tools for Java  extension for VS Code includes debugging support for executables generated by GraalVM Native Image.

- Run an [interactive lab to practice debugging a native executable, deployed in Oracle Cloud](https://luna.oracle.com/lab/cbe9d331-5dbc-4300-a5ca-20b88346cbcf).